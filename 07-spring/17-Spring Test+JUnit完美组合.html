<!DOCTYPE HTML><html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>17-Spring Test+JUnit完美组合</title>
    
<style id="wiz_custom_css">html, body {font-size: 12pt;}body {font-family: Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;line-height: 1.6;margin: 0 auto;padding: 20px 16px;padding: 1.25rem 1rem;}h1, h2, h3, h4, h5, h6 {margin:20px 0 10px;margin:1.25rem 0 0.625rem;padding: 0;font-weight: bold;}h1 {font-size:20pt;font-size:1.67rem;}h2 {font-size:18pt;font-size:1.5rem;}h3 {font-size:15pt;font-size:1.25rem;}h4 {font-size:14pt;font-size:1.17rem;}h5 {font-size:12pt;font-size:1rem;}h6 {font-size:12pt;font-size:1rem;color: #777777;margin: 1rem 0;}div, p, ul, ol, dl, li {margin:0;}blockquote, table, pre, code {margin:8px 0;}ul, ol {padding-left:32px;padding-left:2rem;}ol.wiz-list-level1 > li {list-style-type:decimal;}ol.wiz-list-level2 > li {list-style-type:lower-latin;}ol.wiz-list-level3 > li {list-style-type:lower-roman;}blockquote {padding:0 12px;padding:0 0.75rem;}blockquote > :first-child {margin-top:0;}blockquote > :last-child {margin-bottom:0;}img {border:0;max-width:100%;height:auto !important;margin:2px 0;}table {border-collapse:collapse;border:1px solid #bbbbbb;}td, th {padding:4px 8px;border-collapse:collapse;border:1px solid #bbbbbb;min-height:28px;word-break:break-all;box-sizing: border-box;}.wiz-hide {display:none !important;}</style><style id="wiz_code_style">.wiz-code-container{position: relative; padding:8px 0; margin: 5px 25px 5px 5px;text-indent:0; text-align:left;}.CodeMirror {font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace; color: black; font-size: 10pt; font-size: 0.83rem}.CodeMirror-lines {padding: 4px 0;}.CodeMirror pre {padding: 0 4px;}.CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler {background-color: white;}.CodeMirror-gutters {border-right: 1px solid #ddd; background-color: #f7f7f7; white-space: nowrap;}.CodeMirror-linenumbers {}.CodeMirror-linenumber {padding: 0 3px 0 5px; min-width: 20px; text-align: right; color: #999; white-space: nowrap;}.CodeMirror-guttermarker {color: black;}.CodeMirror-guttermarker-subtle {color: #999;}.CodeMirror-cursor {border-left: 1px solid black; border-right: none; width: 0;}.CodeMirror div.CodeMirror-secondarycursor {border-left: 1px solid silver;}.cm-fat-cursor .CodeMirror-cursor {width: auto; border: 0 !important; background: #7e7;}.cm-fat-cursor div.CodeMirror-cursors {z-index: 1;}.cm-animate-fat-cursor {width: auto; border: 0; -webkit-animation: blink 1.06s steps(1) infinite; -moz-animation: blink 1.06s steps(1) infinite; animation: blink 1.06s steps(1) infinite; background-color: #7e7;}@-moz-keyframes blink {  0% {}  50% { background-color: transparent; }  100% {}}@-webkit-keyframes blink {  0% {}  50% { background-color: transparent; }  100% {}}@keyframes blink {  0% {}  50% { background-color: transparent; }  100% {}}.CodeMirror-overwrite .CodeMirror-cursor {}.cm-tab { display: inline-block; text-decoration: inherit; }.CodeMirror-rulers {position: absolute; left: 0; right: 0; top: -50px; bottom: -20px; overflow: hidden;}.CodeMirror-ruler {border-left: 1px solid #ccc; top: 0; bottom: 0; position: absolute;}.cm-s-default .cm-header {color: blue;}.cm-s-default .cm-quote {color: #090;}.cm-negative {color: #d44;}.cm-positive {color: #292;}.cm-header, .cm-strong {font-weight: bold;}.cm-em {font-style: italic;}.cm-link {text-decoration: underline;}.cm-strikethrough {text-decoration: line-through;}.cm-s-default .cm-keyword {color: #708;}.cm-s-default .cm-atom {color: #219;}.cm-s-default .cm-number {color: #164;}.cm-s-default .cm-def {color: #00f;}.cm-s-default .cm-variable,.cm-s-default .cm-punctuation,.cm-s-default .cm-property,.cm-s-default .cm-operator {}.cm-s-default .cm-variable-2 {color: #05a;}.cm-s-default .cm-variable-3 {color: #085;}.cm-s-default .cm-comment {color: #a50;}.cm-s-default .cm-string {color: #a11;}.cm-s-default .cm-string-2 {color: #f50;}.cm-s-default .cm-meta {color: #555;}.cm-s-default .cm-qualifier {color: #555;}.cm-s-default .cm-builtin {color: #30a;}.cm-s-default .cm-bracket {color: #997;}.cm-s-default .cm-tag {color: #170;}.cm-s-default .cm-attribute {color: #00c;}.cm-s-default .cm-hr {color: #999;}.cm-s-default .cm-link {color: #00c;}.cm-s-default .cm-error {color: #f00;}.cm-invalidchar {color: #f00;}.CodeMirror-composing { border-bottom: 2px solid; }div.CodeMirror span.CodeMirror-matchingbracket {color: #0f0;}div.CodeMirror span.CodeMirror-nonmatchingbracket {color: #f22;}.CodeMirror-matchingtag { background: rgba(255, 150, 0, .3); }.CodeMirror-activeline-background {background: #e8f2ff;}.CodeMirror {position: relative; background: #f5f5f5;}.CodeMirror-scroll {overflow: hidden !important; margin-bottom: 0; margin-right: -30px; padding: 16px 30px 16px 0; outline: none; position: relative;}.CodeMirror-sizer {position: relative; border-right: 30px solid transparent;}.CodeMirror-vscrollbar, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler {position: absolute; z-index: 6; display: none;}.CodeMirror-vscrollbar {right: 0; top: 0; overflow-x: hidden; overflow-y: scroll;}.CodeMirror-hscrollbar {bottom: 0; left: 0 !important; overflow-y: hidden; overflow-x: scroll;}.CodeMirror-scrollbar-filler {right: 0; bottom: 0;}.CodeMirror-gutter-filler {left: 0; bottom: 0;}.CodeMirror-gutters {position: absolute; left: 0; top: -5px; min-height: 100%; z-index: 3;}.CodeMirror-gutter {white-space: normal; height: inherit; display: inline-block; vertical-align: top; margin-bottom: -30px;}.CodeMirror-gutter-wrapper {position: absolute; z-index: 4; background: none !important; border: none !important;}.CodeMirror-gutter-background {position: absolute; top: 0; bottom: 0; z-index: 4;}.CodeMirror-gutter-elt {position: absolute; cursor: default; z-index: 4; text-align: center;}.CodeMirror-gutter-wrapper ::selection { background-color: transparent }.CodeMirror-gutter-wrapper ::-moz-selection { background-color: transparent }.CodeMirror-lines {cursor: text; min-height: 1px;}.CodeMirror pre {-moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; border-width: 0; background: transparent; font-family: inherit; font-size: inherit; margin: 0; white-space: pre; word-wrap: normal; line-height: inherit; color: inherit; z-index: 2; position: relative; overflow: visible; -webkit-tap-highlight-color: transparent; -webkit-font-variant-ligatures: contextual; font-variant-ligatures: contextual;}.CodeMirror-wrap pre {word-wrap: break-word; white-space: pre-wrap; word-break: normal;}.CodeMirror-linebackground {position: absolute; left: 0; right: 0; top: 0; bottom: 0; z-index: 0;}.CodeMirror-linewidget {position: relative; z-index: 2; overflow: auto;}.CodeMirror-widget {}.CodeMirror-rtl pre { direction: rtl; }.CodeMirror-code {outline: none;}.CodeMirror-scroll,.CodeMirror-sizer,.CodeMirror-gutter,.CodeMirror-gutters,.CodeMirror-linenumber {-moz-box-sizing: content-box; box-sizing: content-box;}.CodeMirror-measure {position: absolute; width: 100%; height: 0; overflow: hidden; visibility: hidden;}.CodeMirror-cursor {position: absolute; pointer-events: none;}.CodeMirror-measure pre { position: static; }div.CodeMirror-cursors {visibility: hidden; position: relative; z-index: 3;}div.CodeMirror-dragcursors {visibility: visible;}.CodeMirror-focused div.CodeMirror-cursors {visibility: visible;}.CodeMirror-selected { background: #d9d9d9; }.CodeMirror-focused .CodeMirror-selected { background: #d7d4f0; }.CodeMirror-crosshair { cursor: crosshair; }.CodeMirror-line::selection, .CodeMirror-line > span::selection, .CodeMirror-line > span > span::selection { background: #d7d4f0; }.CodeMirror-line::-moz-selection, .CodeMirror-line > span::-moz-selection, .CodeMirror-line > span > span::-moz-selection { background: #d7d4f0; }.cm-searching {background: #ffa; background: rgba(255, 255, 0, .4);}.cm-force-border { padding-right: .1px; }@media print {  .CodeMirror div.CodeMirror-cursors {visibility: hidden;}}.cm-tab-wrap-hack:after { content: ""; }span.CodeMirror-selectedtext { background: none; }.CodeMirror-activeline-background, .CodeMirror-selected {transition: visibility 0ms 100ms;}.CodeMirror-blur .CodeMirror-activeline-background, .CodeMirror-blur .CodeMirror-selected {visibility:hidden;}.CodeMirror-blur .CodeMirror-matchingbracket {color:inherit !important;outline:none !important;text-decoration:none !important;}</style></head>

<body spellcheck="false" class="" ><div><div style="color:rgb(0, 0, 0);font-family:Arial;font-size:1.225rem;font-style:normal;font-weight:normal;text-align:left;text-indent:0px;background-color:rgb(255, 255, 255);">本着“不写单元测试的程序员不是好程序员”原则，我在坚持写着单元测试，不敢说所有的Java web应用都基于Spring，但至少一半以上都是基于Spring的。</div><div style="color:rgb(0, 0, 0);font-family:Arial;font-size:1.225rem;font-style:normal;font-weight:normal;text-align:left;text-indent:0px;background-color:rgb(255, 255, 255);">发现通过Spring进行bean管理后，做测试会有各种不足，</div><div style="color:rgb(0, 0, 0);font-family:Arial;font-size:1.225rem;font-style:normal;font-weight:normal;text-align:left;text-indent:0px;background-color:rgb(255, 255, 255);"><br></div><div style="color:rgb(0, 0, 0);font-family:Arial;font-size:1.225rem;font-style:normal;font-weight:normal;text-align:left;text-indent:0px;background-color:rgb(255, 255, 255);"><div>例如，很多人做单元测试的时候，还要在Before方法中，初始化Spring容器，导致容器被初始化多次。</div></div></div><div id="wiz_cm_1509416454130_6379" class="wiz-code-container"  data-mode="JavaScript" data-theme="default"><textarea style="display: none;">@Before  
 public void init() {  
      ApplicationContext ctx = new FileSystemXmlApplicationContext( "classpath:spring/spring-basic.xml");  
      baseDao = (IBaseDao) ctx.getBean("baseDao");  
      assertNotNull(baseDao);  
 }    </textarea><wiz_code_mirror><div class="CodeMirror cm-s-default CodeMirror-wrap" data-id="wiz_cm_1509416454130_6379"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 192.699px; left: 104.915px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="0"> }    </textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 29px; margin-bottom: 0px; border-right-width: 30px; min-height: 215px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class=" wiz-hide wiz_CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 75.9375px; top: 172.727px; height: 34.5454px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div class="" style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">@</span><span class="cm-variable">Before</span> &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">public</span> <span class="cm-variable">void</span> <span class="cm-variable">init</span>() { &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-variable">ApplicationContext</span> <span class="cm-variable">ctx</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">FileSystemXmlApplicationContext</span>( <span class="cm-string">"classpath:spring/spring-basic.xml"</span>); &nbsp;</span></pre></div><div style="position: relative;" class=""><div class="CodeMirror-gutter-wrapper" style="left: -29px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-variable">baseDao</span> <span class="cm-operator">=</span> (<span class="cm-variable">IBaseDao</span>) <span class="cm-variable">ctx</span>.<span class="cm-property">getBean</span>(<span class="cm-string">"baseDao"</span>); &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-variable">assertNotNull</span>(<span class="cm-variable">baseDao</span>); &nbsp;</span></pre></div><div style="position: relative;" class="CodeMirror-activeline"><div class=" wiz-hide wiz_CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -29px; width: 29px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -29px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> } &nbsp; &nbsp;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 215px;"></div><div class="CodeMirror-gutters" style="height: 245px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 28px;"></div></div></div></div></wiz_code_mirror></div><div><div style="color:rgb(0, 0, 0);font-family:Arial;font-size:1.225rem;font-style:normal;font-weight:normal;text-align:left;text-indent:0px;background-color:rgb(255, 255, 255);"><div><div><br></div></div></div><span style="color:rgb(0, 0, 0);font-family:Arial;font-size:1.225rem;font-style:normal;font-weight:normal;text-align:left;text-indent:0px;background-color:rgb(255, 255, 255);display:inline !important;">在开发基于Spring的应用时，如果你还直接使用Junit进行单元测试，那你就错过了Spring满汉全席中最重要的一道硬菜。</span><div style="color:rgb(0, 0, 0);font-family:Arial;font-size:1.225rem;font-style:normal;font-weight:normal;text-align:left;text-indent:0px;background-color:rgb(255, 255, 255);"><br></div><div style="color:rgb(0, 0, 0);font-family:Arial;font-size:1.225rem;font-style:normal;font-weight:normal;text-align:left;text-indent:0px;background-color:rgb(255, 255, 255);">再说这道菜之前，我们先来讨论下，在基于Spring的javaweb项目中使用Junit直接进行单元测试有什么不足</div><div style="color:rgb(0, 0, 0);font-family:Arial;font-size:1.225rem;font-style:normal;font-weight:normal;text-align:left;text-indent:0px;background-color:rgb(255, 255, 255);"><br></div><div style="color:rgb(0, 0, 0);font-family:Arial;font-size:1.225rem;font-style:normal;font-weight:normal;text-align:left;text-indent:0px;background-color:rgb(255, 255, 255);"><strong>&nbsp;&nbsp; 1）导致多次Spring容器初始化问题&nbsp;</strong><br><br>&nbsp;&nbsp; 根据JUnit测试方法的调用流程，每执行一个测试方法都会创建一个测试用例的实例并调用setUp()方法。由于一般情况下，我们在setUp()方法中初始化Spring容器，这意味着如果测试用例有多少个测试方法，Spring容器就会被重复初始化多次。虽然初始化Spring容器的速度并不会太慢，但由于可能会在Spring容器初始化时执行加载Hibernate映射文件等耗时的操作，如果每执行一个测试方法都必须重复初始化Spring容器，则对测试性能的影响是不容忽视的；&nbsp;<br><br>&nbsp; &nbsp; /////////使用Spring测试套件，Spring容器只会初始化一次！&nbsp;<br><br>&nbsp;&nbsp;<strong><span>&nbsp;</span>2）需要使用硬编码方式手工获取Bean&nbsp;</strong><br><br>&nbsp;&nbsp;&nbsp; 在测试用例类中我们需要通过ctx.getBean()方法从Spirng容器中获取需要测试的目标Bean，并且还要进行强制类型转换的造型操作。这种乏味的操作迷漫在测试用例的代码中，让人觉得烦琐不堪；&nbsp;<br><br>&nbsp;&nbsp;&nbsp; ////////使用Spring测试套件，测试用例类中的属性会被自动填充Spring容器的对应Bean&nbsp;<br>，无须在手工设置Bean！&nbsp;<br>&nbsp;&nbsp;&nbsp;<br><strong>&nbsp;&nbsp; 3）数据库现场容易遭受破坏&nbsp;</strong><br><br>&nbsp;&nbsp;&nbsp; 测试方法对数据库的更改操作会持久化到数据库中。虽然是针对开发数据库进行操作，但如果数据操作的影响是持久的，可能会影响到后面的测试行为。举个例子，用户在测试方法中插入一条ID为1的User记录，第一次运行不会有问题，第二次运行时，就会因为主键冲突而导致测试用例失败。所以应该既能够完成功能逻辑检查，又能够在测试完成后恢复现场，不会留下“后遗症”；&nbsp;<br><br>&nbsp;&nbsp;&nbsp; ////////使用Spring测试套件，Spring会在你验证后，自动回滚对数据库的操作，保证数据库的现场不被破坏，因此重复测试不会发生问题！&nbsp;<br><br><strong>&nbsp;&nbsp; 4）不方便对数据操作正确性进行检查&nbsp;</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; 假如我们向登录日志表插入了一条成功登录日志，可是我们却没有对t_login_log表中是否确实添加了一条记录进行检查。一般情况下，我们可能是打开数据库，肉眼观察是否插入了相应的记录，但这严重违背了自动测试的原则。试想在测试包括成千上万个数据操作行为的程序时，如何用肉眼进行检查？&nbsp;<br><br>&nbsp; &nbsp; ////////只要你继承Spring的测试套件的用例类，你就可以通过jdbcTemplate在同一事务中访问数据库，查询数据的变化，验证操作的正确性！&nbsp;<br><div><br></div>&nbsp;看完上面的内容，相信，你已经知道我说的硬菜是什么了。</div><div style="color:rgb(0, 0, 0);font-family:Arial;font-size:1.225rem;font-style:normal;font-weight:normal;text-align:left;text-indent:0px;background-color:rgb(255, 255, 255);"><br></div><div style="color:rgb(0, 0, 0);font-family:Arial;font-size:1.225rem;font-style:normal;font-weight:normal;text-align:left;text-indent:0px;background-color:rgb(255, 255, 255);"><strong>下面，让我们看看，使用Spring测试套件后，代码是如何变优雅的。</strong></div><div style="color:rgb(0, 0, 0);font-family:Arial;font-size:1.225rem;font-style:normal;font-weight:normal;text-align:left;text-indent:0px;background-color:rgb(255, 255, 255);"><h2 style="margin:15px auto 2px;padding:0px;font-size:1.4rem;"><a name="t0" target="_blank" style="color:rgb(202, 0, 0);text-decoration:none;"></a><span style="font-size:1.4rem;">1. 加入依赖包</span></h2><p style="margin:10px auto;padding:0px;">　　使用Spring的测试框架需要加入以下<span style="margin:0px;padding:0px;">依赖包</span>：</p><ul style="margin:0px 0px 0px 45px;padding:0px;"><li style="margin:0px 0px 1em;padding:0px;"><span style="margin:0px;padding:0px;">JUnit 4&nbsp;</span></li><li style="margin:0px 0px 1em;padding:0px;"><span style="margin:0px;padding:0px;">Spring Test （Spring框架中的test包）</span></li><li style="margin:0px 0px 1em;padding:0px;"><span style="margin:0px;padding:0px;">Spring 相关其他依赖包（不再赘述了，就是context等包）</span></li></ul><div><br></div><div>如果使用maven，在基于spring的项目中添加如下依赖：</div><div><div><div class="dp-highlighter bg_html" style="font-family:Consolas, &quot;Courier New&quot;, Courier, mono, serif;font-size:1.05rem;background-color:rgb(255, 255, 255);width:936.531px;padding-top:1px;text-align:left;margin:18px 0px !important;"><ol class="dp-xml wiz-list-level1" style="margin:0px 0px 1px 45px !important;padding:0px;list-style:decimal;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);"><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;"><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&lt;</span><span class="tag-name" style="margin:0px;padding:0px;color:rgb(153, 51, 0);font-weight:bold;">dependency</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&gt;</span><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;</span></span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&lt;</span><span class="tag-name" style="margin:0px;padding:0px;color:rgb(153, 51, 0);font-weight:bold;">groupId</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&gt;</span><span style="margin:0px;padding:0px;color:black;">junit</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&lt;/</span><span class="tag-name" style="margin:0px;padding:0px;color:rgb(153, 51, 0);font-weight:bold;">groupId</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&gt;</span><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;</span></span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&lt;</span><span class="tag-name" style="margin:0px;padding:0px;color:rgb(153, 51, 0);font-weight:bold;">artifactId</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&gt;</span><span style="margin:0px;padding:0px;color:black;">junit</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&lt;/</span><span class="tag-name" style="margin:0px;padding:0px;color:rgb(153, 51, 0);font-weight:bold;">artifactId</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&gt;</span><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;</span></span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&lt;</span><span class="tag-name" style="margin:0px;padding:0px;color:rgb(153, 51, 0);font-weight:bold;">version</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&gt;</span><span style="margin:0px;padding:0px;color:black;">4.9</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&lt;/</span><span class="tag-name" style="margin:0px;padding:0px;color:rgb(153, 51, 0);font-weight:bold;">version</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&gt;</span><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;</span></span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&lt;</span><span class="tag-name" style="margin:0px;padding:0px;color:rgb(153, 51, 0);font-weight:bold;">scope</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&gt;</span><span style="margin:0px;padding:0px;color:black;">test</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&lt;/</span><span class="tag-name" style="margin:0px;padding:0px;color:rgb(153, 51, 0);font-weight:bold;">scope</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&gt;</span><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;</span></span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&lt;/</span><span class="tag-name" style="margin:0px;padding:0px;color:rgb(153, 51, 0);font-weight:bold;">dependency</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&gt;</span><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;&nbsp;</span></span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;"><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&lt;</span><span class="tag-name" style="margin:0px;padding:0px;color:rgb(153, 51, 0);font-weight:bold;">dependency</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&gt;</span><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;</span></span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&lt;</span><span class="tag-name" style="margin:0px;padding:0px;color:rgb(153, 51, 0);font-weight:bold;">groupId</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&gt;</span><span style="margin:0px;padding:0px;color:black;">org.springframework</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&lt;/</span><span class="tag-name" style="margin:0px;padding:0px;color:rgb(153, 51, 0);font-weight:bold;">groupId</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&gt;</span><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;</span></span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&lt;</span><span class="tag-name" style="margin:0px;padding:0px;color:rgb(153, 51, 0);font-weight:bold;">artifactId</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&gt;</span><span style="margin:0px;padding:0px;color:black;">spring-test</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&lt;/</span><span class="tag-name" style="margin:0px;padding:0px;color:rgb(153, 51, 0);font-weight:bold;">artifactId</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&gt;</span><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;</span></span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&lt;</span><span class="tag-name" style="margin:0px;padding:0px;color:rgb(153, 51, 0);font-weight:bold;">version</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&gt;</span><span style="margin:0px;padding:0px;color:black;">&nbsp;3.2.4.RELEASE&nbsp;&nbsp;</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&lt;/</span><span class="tag-name" style="margin:0px;padding:0px;color:rgb(153, 51, 0);font-weight:bold;">version</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&gt;</span><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;</span></span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&lt;</span><span class="tag-name" style="margin:0px;padding:0px;color:rgb(153, 51, 0);font-weight:bold;">scope</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&gt;</span><span style="margin:0px;padding:0px;color:black;">provided</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&lt;/</span><span class="tag-name" style="margin:0px;padding:0px;color:rgb(153, 51, 0);font-weight:bold;">scope</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&gt;</span><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;</span></span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&lt;/</span><span class="tag-name" style="margin:0px;padding:0px;color:rgb(153, 51, 0);font-weight:bold;">dependency</span><span class="tag" style="color:rgb(153, 51, 0);margin:0px;padding:0px;font-weight:bold;">&gt;</span><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;&nbsp;</span></span></li></ol></div><br><br></div></div><div><br></div><h2 style="margin:15px auto 2px;padding:0px;font-size:1.4rem;"><a name="t1" target="_blank" style="color:rgb(202, 0, 0);text-decoration:none;"></a><span style="font-size:1.4rem;">2. 创建测试源目录和包</span></h2><p style="margin:10px auto;padding:0px;">　　<span style="margin:0px;padding:0px;">在此，推荐创建一个和src平级的源文件目录，因为src内的类都是为日后产品准备的，而此处的类仅仅用于测试。而包的名称可以和src中的目录同名，这样由于在test源目录中，所以不会有冲突，而且名称又一模一样，更方便检索。这也是Maven的约定。</span></p></div><div style="color:rgb(0, 0, 0);font-family:Arial;font-size:1.225rem;font-style:normal;font-weight:normal;text-align:left;text-indent:0px;background-color:rgb(255, 255, 255);"><br></div><h2 style="margin:0px;padding:0px;color:rgb(0, 0, 0);font-family:Arial;font-style:normal;text-align:left;text-indent:0px;background-color:rgb(255, 255, 255);font-size:1.4rem;"><a name="t2" target="_blank" style="color:rgb(202, 0, 0);text-decoration:none;"></a><span style="font-size:1.4rem;">3、创建测试类</span></h2><div style="color:rgb(0, 0, 0);font-family:Arial;font-size:1.225rem;font-style:normal;font-weight:normal;text-align:left;text-indent:0px;background-color:rgb(255, 255, 255);"><strong><span></span>1）基类,其实就是用来加载配置文件的&nbsp;</strong></div><div style="color:rgb(0, 0, 0);font-family:Arial;font-size:1.225rem;font-style:normal;font-weight:normal;text-align:left;text-indent:0px;background-color:rgb(255, 255, 255);"><div class="dp-highlighter bg_java" style="font-family:Consolas, &quot;Courier New&quot;, Courier, mono, serif;font-size:1.05rem;background-color:rgb(255, 255, 255);width:936.531px;padding-top:1px;text-align:left;margin:18px 0px !important;"><ol class="dp-j wiz-list-level1" style="margin:0px 0px 1px 45px !important;padding:0px;list-style:decimal;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);"><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;"><span class="annotation" style="margin:0px;padding:0px;color:rgb(100, 100, 100);">@RunWith</span><span style="margin:0px;padding:0px;color:black;">(SpringJUnit4ClassRunner.</span><span class="keyword" style="margin:0px;padding:0px;color:rgb(0, 102, 153);font-weight:bold;">class</span><span style="margin:0px;padding:0px;color:black;">)&nbsp;&nbsp;</span><span class="comment" style="margin:0px;padding:0px;color:rgb(0, 130, 0);">//使用junit4进行测试</span><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;</span></span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;"><span class="annotation" style="margin:0px;padding:0px;color:rgb(100, 100, 100);">@ContextConfiguration</span><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;&nbsp;</span></span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;">({<span class="string" style="margin:0px;padding:0px;color:blue;">"/spring/app*.xml"</span><span style="margin:0px;padding:0px;color:black;">,</span><span class="string" style="margin:0px;padding:0px;color:blue;">"/spring/service/app*.xml"</span><span style="margin:0px;padding:0px;color:black;">})&nbsp;</span><span class="comment" style="margin:0px;padding:0px;color:rgb(0, 130, 0);">//加载配置文件</span><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;</span></span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;</span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;"><span class="comment" style="margin:0px;padding:0px;color:rgb(0, 130, 0);">//------------如果加入以下代码，所有继承该类的测试类都会遵循该配置，也可以不加，在测试类的方法上///控制事务，参见下一个实例</span><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;</span></span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;"><span class="comment" style="margin:0px;padding:0px;color:rgb(0, 130, 0);">//这个非常关键，如果不加入这个注解配置，事务控制就会完全失效！</span><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;</span></span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;"><span class="comment" style="margin:0px;padding:0px;color:rgb(0, 130, 0);">//@Transactional</span><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;</span></span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;"><span class="comment" style="margin:0px;padding:0px;color:rgb(0, 130, 0);">//这里的事务关联到配置文件中的事务控制器（transactionManager&nbsp;=&nbsp;"transactionManager"），同时//指定自动回滚（defaultRollback&nbsp;=&nbsp;true）。这样做操作的数据才不会污染数据库！</span><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;</span></span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;"><span class="comment" style="margin:0px;padding:0px;color:rgb(0, 130, 0);">//@TransactionConfiguration(transactionManager&nbsp;=&nbsp;"transactionManager",&nbsp;defaultRollback&nbsp;=&nbsp;true)</span><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;</span></span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;"><span class="comment" style="margin:0px;padding:0px;color:rgb(0, 130, 0);">//------------</span><span style="margin:0px;padding:0px;color:black;">&nbsp;&nbsp;</span></span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;"><span class="keyword" style="margin:0px;padding:0px;color:rgb(0, 102, 153);font-weight:bold;">public</span><span style="margin:0px;padding:0px;color:black;">&nbsp;</span><span class="keyword" style="margin:0px;padding:0px;color:rgb(0, 102, 153);font-weight:bold;">class</span><span style="margin:0px;padding:0px;color:black;">&nbsp;BaseJunit4Test&nbsp;{&nbsp;&nbsp;</span></span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;list-style-type:decimal-leading-zero;background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);list-style-position:outside !important;"><span style="margin:0px;padding:0px;color:black;">}&nbsp;&nbsp;</span></li></ol></div><br><br></div><div style="color:rgb(0, 0, 0);font-family:Arial;font-size:1.225rem;font-style:normal;font-weight:normal;text-align:left;text-indent:0px;background-color:rgb(255, 255, 255);"><strong><br><span></span>2）接着是我们自己的测试类&nbsp;</strong></div></div><div id="wiz_cm_1509416489373_7671" class="wiz-code-container"  data-mode="JavaScript" data-theme="default"><textarea style="display: none;">public class UserAssignServiceTest extends BaseJunit4Test{  
  
       @Resource  //自动注入,默认按名称  
         private IBaseDao baseDao;  
      
    @Test   //标明是测试方法  
    @Transactional   //标明此方法需使用事务  
    @Rollback(false)  //标明使用完此方法后事务不回滚,true时为回滚  
     public void insert( ) {  
            String sql="insert into user(name,password) values(?,?)";  
            Object[] objs=new Object[]{"00","000"};  
            baseDao.insert( sql , objs );  
          
            String sql1="select * from user where name=? and password=? ";  
            List&lt;Map&lt;String,Object&gt;&gt; list=baseDao.queryForList( sql1 , objs );  
            System.out.println(list);  
            assertTrue(list.size( )&gt;0);   
         }  
}  </textarea><wiz_code_mirror><div class="CodeMirror cm-s-default CodeMirror-wrap" data-id="wiz_cm_1509416489373_7671"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 607.244px; left: 183.267px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="0"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 36px; margin-bottom: 0px; border-right-width: 30px; min-height: 664px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class=" wiz-hide wiz_CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 147.273px; top: 587.272px; height: 34.5454px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div class="" style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -36px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 25px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">public</span> <span class="cm-keyword">class</span> <span class="cm-def">UserAssignServiceTest</span> <span class="cm-keyword">extends</span> <span class="cm-variable">BaseJunit4Test</span>{ &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -36px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 25px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -36px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 25px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-operator">@</span><span class="cm-variable">Resource</span> &nbsp;<span class="cm-comment">//自动注入,默认按名称 &nbsp;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -36px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 25px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-property">private</span> <span class="cm-def">IBaseDao</span> <span class="cm-def">baseDao</span>; &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -36px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 25px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -36px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 25px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-operator">@</span><span class="cm-variable">Test</span> &nbsp; <span class="cm-comment">//标明是测试方法 &nbsp;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -36px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 25px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-operator">@</span><span class="cm-variable">Transactional</span> &nbsp; <span class="cm-comment">//标明此方法需使用事务 &nbsp;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -36px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 25px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-operator">@</span><span class="cm-variable">Rollback</span>(<span class="cm-atom">false</span>) &nbsp;<span class="cm-comment">//标明使用完此方法后事务不回滚,true时为回滚 &nbsp;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -36px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 25px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-property">public</span> <span class="cm-def">void</span> <span class="cm-def">insert</span>( ) { &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -36px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 25px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">String</span> <span class="cm-variable">sql</span><span class="cm-operator">=</span><span class="cm-string">"insert into user(name,password) values(?,?)"</span>; &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -36px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 25px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">Object</span>[] <span class="cm-variable">objs</span><span class="cm-operator">=</span><span class="cm-keyword">new</span> <span class="cm-variable">Object</span>[]{<span class="cm-string">"00"</span>,<span class="cm-string">"000"</span>}; &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -36px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 25px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">baseDao</span>.<span class="cm-property">insert</span>( <span class="cm-variable">sql</span> , <span class="cm-variable">objs</span> ); &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -36px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 25px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -36px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 25px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">String</span> <span class="cm-variable">sql1</span><span class="cm-operator">=</span><span class="cm-string">"select * from user where name=? and password=? "</span>; &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -36px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 25px;">15</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">List</span><span class="cm-operator">&lt;</span><span class="cm-variable">Map</span><span class="cm-operator">&lt;</span><span class="cm-variable">String</span>,<span class="cm-variable">Object</span><span class="cm-operator">&gt;&gt;</span> <span class="cm-variable">list</span><span class="cm-operator">=</span><span class="cm-variable">baseDao</span>.<span class="cm-property">queryForList</span>( <span class="cm-variable">sql1</span> , <span class="cm-variable">objs</span> ); &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -36px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 25px;">16</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">System</span>.<span class="cm-property">out</span>.<span class="cm-property">println</span>(<span class="cm-variable">list</span>); &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -36px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 25px;">17</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">assertTrue</span>(<span class="cm-variable">list</span>.<span class="cm-property">size</span>( )<span class="cm-operator">&gt;</span><span class="cm-number">0</span>); &nbsp; </span></pre></div><div class="CodeMirror-activeline" style="position: relative;"><div class=" wiz-hide wiz_CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -36px; width: 36px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -36px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 25px;">18</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; } &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -36px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 25px;">19</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">} &nbsp;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 664px;"></div><div class="CodeMirror-gutters" style="height: 694px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 34px;"></div></div></div></div></wiz_code_mirror></div><div><br></div></body></html>