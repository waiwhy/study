<!DOCTYPE HTML><html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>13-个人理解的SpringAOP事务管理</title>
    
<style id="wiz_custom_css">html, body {font-size: 12pt;}body {font-family: Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;line-height: 1.6;margin: 0 auto;padding: 20px 16px;padding: 1.25rem 1rem;}h1, h2, h3, h4, h5, h6 {margin:20px 0 10px;margin:1.25rem 0 0.625rem;padding: 0;font-weight: bold;}h1 {font-size:20pt;font-size:1.67rem;}h2 {font-size:18pt;font-size:1.5rem;}h3 {font-size:15pt;font-size:1.25rem;}h4 {font-size:14pt;font-size:1.17rem;}h5 {font-size:12pt;font-size:1rem;}h6 {font-size:12pt;font-size:1rem;color: #777777;margin: 1rem 0;}div, p, ul, ol, dl, li {margin:0;}blockquote, table, pre, code {margin:8px 0;}ul, ol {padding-left:32px;padding-left:2rem;}ol.wiz-list-level1 > li {list-style-type:decimal;}ol.wiz-list-level2 > li {list-style-type:lower-latin;}ol.wiz-list-level3 > li {list-style-type:lower-roman;}blockquote {padding:0 12px;padding:0 0.75rem;}blockquote > :first-child {margin-top:0;}blockquote > :last-child {margin-bottom:0;}img {border:0;max-width:100%;height:auto !important;margin:2px 0;}table {border-collapse:collapse;border:1px solid #bbbbbb;}td, th {padding:4px 8px;border-collapse:collapse;border:1px solid #bbbbbb;min-height:28px;word-break:break-all;box-sizing: border-box;}.wiz-hide {display:none !important;}</style></head>

<body class=""  spellcheck="false"><div></div><h1 class="csdn_top" style="margin:0px;font-size:1.5rem;font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-weight:700;color:rgb(44, 48, 51);padding:0px 29px;font-style:normal;text-align:start;text-indent:0px;">个人理解的SpringAOP事务管理</h1><div class="article_bar clearfix" style="margin:5px 0px 0px;padding:0px 29px 8px;font-weight:normal;color:rgb(136, 136, 136);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(229, 229, 229);font-size:0.875rem;font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-style:normal;text-align:start;text-indent:0px;"><div class="artical_tag" style="margin:0px;padding:0px;font-weight:400;"><span class="original" style="margin:0px 20px 0px 0px;padding:2px 6px;font-weight:400;border:1px solid rgb(228, 235, 244);font-size:0.875rem;color:rgb(120, 144, 156);">原创<span class="Apple-converted-space">&nbsp;</span></span><span class="time" style="margin:0px;padding:0px;font-weight:400;display:inline-block;color:rgb(187, 187, 187);font-size:0.875rem;">2017年03月20日 21:12:46</span></div><ul class="right_bar" style="margin:5px 0px 0px;padding:0px;font-weight:400;list-style:none;"><li style="margin:0px 0px 0px 30px;padding:0px;font-weight:400;list-style:none;"><button class="btn-noborder" style="margin:0px;font-size:0.875rem;border:0px;padding:0px;font-weight:400;display:inline-block;text-align:center;color:rgb(136, 136, 136);background:rgba(0, 0, 0, 0);"><i class="icon iconfont icon-read" style="font-style:normal;font-size:1rem;font-family:iconfont !important;display:inline-block;margin-right:8px;color:rgb(187, 187, 187);"></i><span class="txt" style="margin:0px;padding:0px;font-weight:400;color:rgb(187, 187, 187);display:inline-block;">652</span></button></li></ul></div><div id="article_content" class="article_content csdn-tracking-statistics tracking-click" data-mod="popu_519" data-dsm="post" style="margin:0px 0px 30px;padding:20px 30px 0px;font-weight:normal;color:rgb(69, 69, 69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:1rem;font-style:normal;text-align:start;text-indent:0px;"><p style="margin:0px;padding:0px;font-weight:400;">改天得好好去看看深入解析Spring的数据。</p><p style="margin:0px;padding:0px;font-weight:400;"><br></p><p style="margin:0px;padding:0px;font-weight:400;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;<strong style="font-weight:bold;">先了解AOP的相关术语:</strong></span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">1.通知(Advice):</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">通知定义了切面是什么以及何时使用。描述了切面要完成的工作和何时需要执行这个工作。</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">2.连接点(Joinpoint):</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">程序能够应用通知的一个“时机”，这些“时机”就是连接点，例如方法被调用时、异常被抛出时等等。</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">3.切入点(Pointcut)</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">通知定义了切面要发生的“故事”和时间，那么切入点就定义了“故事”发生的地点，例如某个类或方法的名称，</span><a href="http://lib.csdn.net/base/javaee" class="replace_word" title="Java EE知识库" target="_blank" style="color:rgb(223, 52, 52);text-decoration:none;margin:0px;padding:0px;font-weight:bold;font-family:Arial;font-size:0.875rem;">spring</a><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">中允许我们方便的用正则表达式来指定</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">4.切面(Aspect)</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">通知和切入点共同组成了切面：时间、地点和要发生的“故事”</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">5.引入(Introduction)</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">引入允许我们向现有的类添加新的方法和属性(Spring提供了一个方法注入的功能）</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">6.目标(Target)</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">即被通知的对象，如果没有AOP,那么它的逻辑将要交叉别的事务逻辑，有了AOP之后它可以只关注自己要做的事（AOP让他做爱做的事）</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">7.代理(proxy)</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">应用通知的对象，详细内容参见设计模式里面的代理模式</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">8.织入(Weaving)</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">把切面应用到目标对象来创建新的代理对象的过程，织入一般发生在如下几个时机:</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">(1)编译时：当一个类文件被编译时进行织入，这需要特殊的编译器才可以做的到，例如AspectJ的织入编译器</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">(2)类加载时：使用特殊的ClassLoader在目标类被加载到程序之前增强类的字节代码</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">(3)运行时：切面在运行的某个时刻被织入,SpringAOP就是以这种方式织入切面的，原理应该是使用了JDK的动态代理技术</span><br></p><p style="margin:0px;padding:0px;font-weight:400;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br></span></p><p style="margin:0px;padding:0px;font-weight:400;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><strong style="font-weight:bold;">Spring提供了4种实现AOP的方式：</strong></span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">1.经典的基于代理的AOP</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">2.@AspectJ注解驱动的切面</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">3.纯POJO切面</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">4.注入式AspectJ切面</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br></p><p style="margin:0px;padding:0px;font-weight:400;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><strong style="font-weight:bold;">Spring支持五种类型的通知：</strong></span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">Before(前)&nbsp; org.apringframework.aop.MethodBeforeAdvice</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">After-returning(返回后) org.springframework.aop.AfterReturningAdvice</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">After-throwing(抛出后) org.springframework.aop.ThrowsAdvice</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">Arround(周围) org.aopaliance.intercept.MethodInterceptor</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">Introduction(引入) org.springframework.aop.IntroductionInterceptor</span><br></p><p style="margin:0px;padding:0px;font-weight:400;"><br></p><p style="margin:0px;padding:0px;font-weight:400;"><br></p><p style="margin:0px;padding:0px;font-weight:400;"></p><span style="margin:0px;padding:0px;font-weight:400;"><strong style="font-weight:bold;">1、使用基于注解的AOP事务管理&nbsp;</strong><br>&lt;tx:annotation-driven transaction-manager="transactionManager"/&gt;&nbsp;<br>&lt;aop:aspectj-autoproxy /&gt;&nbsp;<br><br><br>探索tx:annotation-driven标签：&nbsp;<br>&lt;tx:annotation-driven/&gt;标签是注解驱动的事务管理支持的核心。&nbsp;<br><br>&lt;tx:annotation-driven/&gt;标签的属性：&nbsp;<br>transaction-manager：指定到现有的PlatformTransactionManager bean的引用，通知会使用该引用。default="transactionManager"&nbsp;<br>mode：指定Spring事务管理框架创建通知bean的方式。可用的值有proxy和aspectj。前者是默认值，表示通知对象是个JDK代理；后者表示Spring AOP会使用AspectJ创建代理。&nbsp;<br>order：指定创建的切面的顺序。只要目标对象有多个通知就可以使用该属性。&nbsp;<br>proxy-target-class：该属性如果为true就表示你想要代理目标类而不是bean所实现的所有接口。default="false"&nbsp;<br><br>探索@Transactional注解：&nbsp;<br>你可以指定传播、隔离级别、超时以及允许和不允许的异常。&nbsp;<br>@Transactional注解的属性:&nbsp;<br>propagation：指定事务定义中使用的传播&nbsp;<br>isolation：设定事务的隔离级别&nbsp;<br>timeout：指定事务的超市（秒）&nbsp;<br>readOnly：指定事务的超时&nbsp;<br>noRollbackFor：目标方法可抛出的异常所构成的数组，但通知仍会提交事务&nbsp;<br>rollbackFor：异常所构成的数组，如果目标方法抛出了这些异常，通知就会回滚事务&nbsp;<br><br><br><br>基于注解的事务管理小结：&nbsp;<br>如果定义在类上，那么所有的方法都使用相同的方式，有些read就会抱怨给太多的东西了。&nbsp;<br>如果在每个方法上都定义注解，那么就会很麻烦。&nbsp;<br>（可以使用XML AOP事务管理能更好的处理这种情况）&nbsp;<br><br><br><br><br><br><br><br><strong style="font-weight:bold;">2、使用XML AOP事务管理&nbsp;</strong><br>&lt;tx:advice/&gt;标签，该标签会创建一个事务处理通知。</span><div class="dp-highlighter" style="margin:18px 0px !important;padding:1px 0px 0px;font-weight:400;font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:0.75rem;width:851.393px;text-align:left;background-color:rgb(231, 229, 220);"><div class="bar" style="margin:0px;padding:0px 0px 0px 45px;font-weight:400;"><div class="tools" style="margin:0px;padding:3px 8px 10px 10px;font-weight:normal;font-style:normal;font-size:0.563rem;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;border-left-width:3px;border-left-style:solid;border-left-color:rgb(108, 226, 108);border-right-width:1px;border-right-style:solid;border-right-color:rgb(231, 229, 220);background-color:rgb(248, 248, 248);"><a href="http://localhost:8033/jforum/posts/list/0/79.page#" target="_blank" style="color:rgb(160, 160, 160);text-decoration:none;margin:0px 10px 0px 0px;padding:0px;font-weight:400;border:none;font-size:0.563rem;display:inline-block;width:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat;">view plain</a><a href="http://localhost:8033/jforum/posts/list/0/79.page#" target="_blank" style="color:rgb(160, 160, 160);text-decoration:none;margin:0px 10px 0px 0px;padding:0px;font-weight:400;border:none;font-size:0.563rem;display:inline-block;width:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat;">copy to clipboard</a><a href="http://localhost:8033/jforum/posts/list/0/79.page#" target="_blank" style="color:rgb(160, 160, 160);text-decoration:none;margin:0px 10px 0px 0px;padding:0px;font-weight:400;border:none;font-size:0.563rem;display:inline-block;width:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat;">print</a><a href="http://localhost:8033/jforum/posts/list/0/79.page#" target="_blank" style="color:rgb(160, 160, 160);text-decoration:none;margin:0px 10px 0px 0px;padding:0px;font-weight:400;border:none;font-size:0.563rem;display:inline-block;width:16px;text-indent:-2000px;background-position:0% 0%;background-repeat:no-repeat;">?</a></div></div><ol class="dp-j wiz-list-level1" style="margin:0px 0px 1px 45px !important;padding:0px;font-weight:400;list-style:decimal;border:none;color:rgb(92, 92, 92);background-color:rgb(255, 255, 255);"><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);display:list-item;background-color:rgb(255, 255, 255);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&lt;tx:advice id=</span><span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"txAdvice"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;transaction-manager=</span><span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"transactionManager"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&gt;&nbsp;&nbsp;</span></span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);color:rgb(92, 92, 92);display:list-item;background-color:rgb(248, 248, 248);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&lt;tx:attributes&gt;&nbsp;&nbsp;</span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);display:list-item;background-color:rgb(255, 255, 255);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tx:method name=<span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"bulk*"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;propagation=</span><span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"REQUIRED"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;isolation=</span><span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"DEFAULT"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;/&gt;&nbsp;&nbsp;</span></span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);color:rgb(92, 92, 92);display:list-item;background-color:rgb(248, 248, 248);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tx:method name=<span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"load*"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;propagation=</span><span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"REQUIRED"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;isolation=</span><span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"DEFAULT"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;read-only=</span><span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"true"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">/&gt;&nbsp;&nbsp;</span></span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);display:list-item;background-color:rgb(255, 255, 255);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tx:attributes&gt;&nbsp;&nbsp;</span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);color:rgb(92, 92, 92);display:list-item;background-color:rgb(248, 248, 248);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&lt;/tx:advice&gt;&nbsp;&nbsp;</span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);display:list-item;background-color:rgb(255, 255, 255);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&lt;aop:config&gt;&nbsp;&nbsp;</span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);color:rgb(92, 92, 92);display:list-item;background-color:rgb(248, 248, 248);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;aop:advisor pointcut=<span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"execution(* *..*Service*.*(..))"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;advice-ref=</span><span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"txAdvice"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;/&gt;&nbsp;&nbsp;</span></span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);display:list-item;background-color:rgb(255, 255, 255);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&lt;/aop:config&gt;&nbsp;&nbsp;</span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);color:rgb(92, 92, 92);display:list-item;background-color:rgb(248, 248, 248);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;</span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);display:list-item;background-color:rgb(255, 255, 255);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">或&nbsp;&nbsp;</span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);color:rgb(92, 92, 92);display:list-item;background-color:rgb(248, 248, 248);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;</span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);display:list-item;background-color:rgb(255, 255, 255);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&lt;aop:config&gt;&nbsp;&nbsp;</span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);color:rgb(92, 92, 92);display:list-item;background-color:rgb(248, 248, 248);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&lt;aop:pointcut id=<span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"allServiceMethods"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;</span></span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);display:list-item;background-color:rgb(255, 255, 255);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expression=<span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"execution(* com.apress.prospring2.ch16.services.*.*(..))"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">/&gt;&nbsp;&nbsp;</span></span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);color:rgb(92, 92, 92);display:list-item;background-color:rgb(248, 248, 248);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&lt;aop:advisor advice-ref=<span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"defaultTransactionAdvice"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;</span></span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);display:list-item;background-color:rgb(255, 255, 255);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pointcut-ref=<span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"allServiceMethods"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">/&gt;&nbsp;&nbsp;</span></span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);color:rgb(92, 92, 92);display:list-item;background-color:rgb(248, 248, 248);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&lt;/aop:config&gt;&nbsp;&nbsp;</span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);display:list-item;background-color:rgb(255, 255, 255);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;</span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);color:rgb(92, 92, 92);display:list-item;background-color:rgb(248, 248, 248);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&lt;tx:advice id=<span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"defaultTransactionAdvice"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;transaction-manager=</span><span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"transactionManager"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&gt;&nbsp;&nbsp;</span></span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);display:list-item;background-color:rgb(255, 255, 255);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&lt;tx:attributes&gt;&nbsp;&nbsp;</span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);color:rgb(92, 92, 92);display:list-item;background-color:rgb(248, 248, 248);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tx:method&nbsp;&nbsp;</span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);display:list-item;background-color:rgb(255, 255, 255);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name=<span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"*"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;</span></span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);color:rgb(92, 92, 92);display:list-item;background-color:rgb(248, 248, 248);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isolation=<span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"DEFAULT"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;</span></span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);display:list-item;background-color:rgb(255, 255, 255);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;propagation=<span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"REQUIRED"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;</span></span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);color:rgb(92, 92, 92);display:list-item;background-color:rgb(248, 248, 248);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no-rollback-<span class="keyword" style="margin:0px;padding:0px;font-weight:700;color:rgb(0, 102, 153);font-size:0.875rem;border-radius:2px;border:none;">for</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">=</span><span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"java.lang.RuntimeException"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;</span></span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);display:list-item;background-color:rgb(255, 255, 255);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timeout=<span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"100"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">/&gt;&nbsp;&nbsp;</span></span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);color:rgb(92, 92, 92);display:list-item;background-color:rgb(248, 248, 248);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tx:method&nbsp;&nbsp;</span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);display:list-item;background-color:rgb(255, 255, 255);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name=<span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"get*"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;</span></span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);color:rgb(92, 92, 92);display:list-item;background-color:rgb(248, 248, 248);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read-only=<span class="string" style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 255);">"true"</span><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">/&gt;&nbsp;&nbsp;</span></span></li><li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);display:list-item;background-color:rgb(255, 255, 255);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tx:attributes&gt;&nbsp;&nbsp;</span></li><li style="margin:0px !important;padding:0px 3px 0px 10px !important;font-weight:400;list-style:decimal outside;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108, 226, 108);color:rgb(92, 92, 92);display:list-item;background-color:rgb(248, 248, 248);"><span style="margin:0px;padding:0px;font-weight:400;border:none;color:rgb(0, 0, 0);">&lt;/tx:advice&gt;&nbsp;&nbsp;</span></li></ol></div><br><br><br><br><br><br><br><strong style="font-weight:bold;"><br>3、tx:advice标签简介&nbsp;</strong><br>id是该advice bean的标识，而transaction-manager则必须引用一个PlatformTransactionManager bean。&nbsp;<br>还可以通过&lt;tx:attributes&gt;标签定制&lt;tx:advice&gt;标签所创建的通知的行为。&nbsp;<br><br>&lt;tx:method/&gt;标签的属性：&nbsp;<br>name：方法名的匹配模式，通知根据该模式寻找匹配的方法。&nbsp;<br>propagation：设定事务定义所用的传播级别。&nbsp;<br>isolation：设置事务的隔离级别。&nbsp;<br>timeout：指定事务的超时（秒）。&nbsp;<br>read-only：该属性为true指示事务是只读的&nbsp;<br>no-rollback-for：以逗号分隔的异常类的列表，目标方法可以跑出这些异常而不会导致通知执行回滚&nbsp;<br>rollback-for：以逗号分隔的异常类的列表，当目标方法跑出这些异常时会导致通知执行回滚。默认情况下，该列表为空，因此不在no-rollback-for列表中的任何运行时异常都会导致回滚。&nbsp;<br><br><br><br>&lt;tx:method&gt;中isolation（隔离）和propagation（传播）参数的含义：&nbsp;<br>getIsolationLevel：他对其他事务所看到的数据变化进行控制。&nbsp;<br>事务隔离级别：&nbsp;<br>隔离级别 说明&nbsp;<br>ISOLATION_DEFAULT 默认级别（对大多数数据库来说就是ISOLATION_READ_COMMITTED）&nbsp;<br>ISOLATION_READ_UNCOMMITTED 最低的隔离级别。事实上我们不应该隔离级别，因为在事务完成前，其他事务可以看到该事务所修改的数据。而在其他事务提交前，该事务也可以看到其他事务所做的修改。&nbsp;<br>ISOLATION_READ_COMMITTED 大多数数据库的默认级别。在事务完成前，其他事务无法看到该事务所修改的数据。遗憾的是，在该事务提交后，你就可以查看其他事务插入活更新的数据。这意味着在事务的不同点上，如果其他事务修改数据，你会看到不同的数据。&nbsp;<br>ISOLATION_REPEATABLE_READ 该隔离级别确保如果在事务中查询了某个数据集，你至少还能再次查询到相同的数据集，即使其他事务修改了所查询的数据。然而如果其他事务插入了新数据，你就可以查询到该新插入的数据。&nbsp;<br>ISOLATION_SERIALIZABLE 代价最大、可靠性最高的隔离级别，所有的事务都是俺顺序一个接一个的执行。&nbsp;<br><br>getPropagationBehavior：指定了当代码请求一个新的事务时Spring所做的事情。&nbsp;<br>传播行为指：&nbsp;<br>传播行为 说明&nbsp;<br>PROPAGATION_REQUIRED 当前如果有事务，Spring就会使用该事务；否则会开始一个新事务。&nbsp;<br>PROPAGATION_SUPPORTS 当前如果有事务，Spring就会使用该事务；否则不会开启一个新事务。&nbsp;<br>PROPAGATION_MANDATORY 当前如果有事务，Spring就会使用该事务；否则会抛出异常。&nbsp;<br>PROPAGATION_REQUIRES_NEW Spring总会开始一个新事务。如果当前有事务，则该事务挂起。&nbsp;<br>PROPAGATION_NOT_SUPPORTED Spring不会执行事务中的代码。代码总是在非事务环境下执行，如果当期有事务，则该事务挂起。&nbsp;<br>PROPAGATION_NEVER 即使当前有事务，Spring也会在飞事务环境下执行。如果当前有事务，则抛出异常。&nbsp;<br><p style="margin:0px;padding:0px;font-weight:400;">PROPAGATION_NESTED 如果当前有事务，则在嵌套事务中执行。如果没有，那么执行情况与PROPAGATION_REQUIRED一样。&nbsp;</p><p style="margin:0px;padding:0px;font-weight:400;"><br></p><p style="margin:0px;padding:0px;font-weight:400;"><br></p><p style="margin:0px;padding:0px;font-weight:400;">平时看一篇大牛写的案例给你们举个例子</p><p style="margin:0px;padding:0px;font-weight:400;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">具体做法。。。大晚上的就举个睡觉的例子吧:</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">首先写一个接口叫Sleepable,这是一个牛X的接口,所有具有睡觉能力的东西都可以实现该接口（不光生物，包括关机选项里面的休眠）</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">package test.spring.aop.bean</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">public interface Sleepable{</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; void sleep();&nbsp;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">}</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">然后写一个Human类，他实现了这个接口</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">package test.spring.aop.bean</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">public Human implements Sleepable{</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp; /*这人莫非跟寡人差不多？</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; *除了睡觉睡的比较好之外其余的什么也不会做？*/</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp; public void sleep(){</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("睡觉了！梦中自有颜如玉！");</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp; }</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">}</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">好了，这是主角，不过睡觉前后要做些辅助工作的，最基本的是脱穿衣服，失眠的人还要吃安眠药什么的,但是这些动作与纯粹的睡觉这一“业务逻辑”是不相干的，如果把</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">这些代码全部加入到sleep方法中，是不是有违单一职责呢？，这时候我们就需要AOP了。</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">编写一个SleepHelper类，它里面包含了睡觉的辅助工作,用AOP术语来说它就应该是通知了，我们需要实现上面的接口</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">package test.spring.aop.bean;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">import&nbsp;</span><a href="http://lib.csdn.net/base/javase" class="replace_word" title="Java SE知识库" target="_blank" style="color:rgb(223, 52, 52);text-decoration:none;margin:0px;padding:0px;font-weight:bold;font-family:Arial;font-size:0.875rem;">Java</a><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">.lang.reflect.Method;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">import org.springframework.aop.AfterReturningAdvice;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">import org.springframework.aop.MethodBeforeAdvice;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">public class SleepHelper implements MethodBeforeAdvice,AfterReturningAdvice{</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; public void before(Method mtd, Object[] arg1, Object arg2)</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; throws Throwable {</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; System.out.println("通常情况下睡觉之前要脱衣服！");</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; }</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; public void afterReturning(Object arg0, Method arg1, Object[] arg2,</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Object arg3) throws Throwable {</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; System.out.println("起床后要先穿衣服！");</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; }</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp;&nbsp;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">}</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">然后在spring配置文件中进行配置:</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&lt;bean id="sleepHelper" class="test.spring.aop.bean.SleepHelper"&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&lt;/bean&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">OK!现在创建通知的工作就完成了.</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">第二步是进行配置，这是很令人蛋疼的操作，尤其是这么热的天，Spring又把东西的名字起的见鬼的长！它为啥不能像usr这种风格呢？</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">首先要做的是配置一个切点,据说切点的表示方式在Spring中有好几种，但是常用的只有两种：1.使用正则表达式 2.使用AspectJ表达式 AspectJ我不是很熟悉(我也是熟悉</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">党 or 精通党？),我还是习惯用正则表达式</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">Spring使用org.springframework.aop.support.JdkRegexpMethodPointcut来定义正则表达式切点</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&lt;bean id="spleepPointcut" class="org.springframework.aop.support.JdkRegexpMethodPointcut"&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp; &lt;property name="pattern" value=".*sleep"/&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&lt;/bean&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">pattern属性指定了正则表达式，它匹配所有的sleep方法</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">切点仅仅是定义了故事发生的地点，还有故事发生的时间以及最重要的故事的内容,就是通知了，我们需要把通知跟切点结合起来，我们要使用的通知者是:</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">org.springframework.aop.support.DefaultPointcutAdvisor</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&lt;bean id="sleepHelperAdvisor" class="org.springframework.aop.support.DefaultPointcutAdvisor"&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name="advice" ref="sleepHelper"/&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name="pointcut" ref="sleepPointcut"/&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&lt;/bean&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">切入点和通知都配置完成，接下来该调用ProxyFactoryBean产生代理对象了</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&lt;bean id="humanProxy" class="org.springframework.aop.framework.ProxyFactoryBean"&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name="target" ref="human"/&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name="interceptorNames" value="sleepHelperAdvisor" /&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name="proxyInterfaces" value="test.spring.aop.bean.Sleepable" /&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&lt;/bean&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">ProxyFactoryBean是一个代理，我们可以把它转换为proxyInterfaces中指定的实现该interface的代理对象:</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">import org.springframework.aop.framework.ProxyFactoryBean;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">import org.springframework.context.ApplicationContext;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">import org.springframework.context.support.ClassPathXmlApplicationContext;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">import test.spring.aop.bean.Sleepable;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">public class Test {</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; public static void main(String[] args){</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ApplicationContext appCtx = new ClassPathXmlApplicationContext("applicationContext.xml");</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Sleepable sleeper = (Sleepable)appCtx.getBean("humanProxy");</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sleeper.sleep();</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; }</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">}</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">程序运行产生结果：</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">通常情况下睡觉之前要脱衣服！</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">睡觉啦~梦中自有颜如玉!</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">起床后要先穿衣服！</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">OK!这是我们想要的结果，但是上面这个过程貌似有点复杂，尤其是配置切点跟通知,Spring提供了一种自动代理的功能，能让切点跟通知自动进行匹配，修改配置文件如下:</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&lt;bean id="sleepHelper" class="test.spring.aop.bean.SleepHelper"&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp; &lt;/bean&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp; &lt;bean id="sleepAdvisor" class="org.springframework.aop.support.RegexpMethodPointcutAdvisor"&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &lt;property name="advice" ref="sleepHelper"/&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &lt;property name="pattern" value=".*sleep"/&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp; &lt;/bean&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp; &lt;bean id="human" class="test.spring.aop.bean.Human"&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp; &lt;/bean&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp; &lt;bean class="org.springframework.aop.framework.autoproxy.DefaultAdvisorAutoProxyCreator"/&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">执行程序：</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">public class Test {</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; public static void main(String[] args){</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ApplicationContext appCtx = new ClassPathXmlApplicationContext("applicationContext.xml");</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Sleepable sleeper = (Sleepable)appCtx.getBean("human");</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sleeper.sleep();</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; }</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">}</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">成功输出结果跟前面一样!</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">只要我们声明了org.springframework.aop.framework.autoproxy.DefaultAdvisorAutoProxyCreator(我勒个去的，名太长了)就能为方法匹配的bean自动创建代理！</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">但是这样还是要有很多工作要做,有更简单的方式吗?有！</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">一种方式是使用AspectJ提供的注解:</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">package test.mine.spring.bean;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">import org.aspectj.lang.annotation.AfterReturning;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">import org.aspectj.lang.annotation.Aspect;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">import org.aspectj.lang.annotation.Before;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">import org.aspectj.lang.annotation.Pointcut;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">@Aspect</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">public class SleepHelper {</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; public SleepHelper(){</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; }</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp;&nbsp;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; @Pointcut("execution(* *.sleep())")</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; public void sleeppoint(){}</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp;&nbsp;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; @Before("sleeppoint()")</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; public void beforeSleep(){</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; System.out.println("睡觉前要脱衣服!");</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; }</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp;&nbsp;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; @AfterReturning("sleeppoint()")</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; public void afterSleep(){</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; System.out.println("睡醒了要穿衣服！");</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; }</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp;&nbsp;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">}</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">用@Aspect的注解来标识切面,注意不要把它漏了，否则Spring创建代理的时候会找不到它,@Pointcut注解指定了切点，@Before和@AfterReturning指定了运行时的通知，注</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">意的是要在注解中传入切点的名称</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">然后我们在Spring配置文件上下点功夫,首先是增加AOP的XML命名空间和声明相关schema</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">命名空间:</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">xmlns:aop="http://www.springframework.org/schema/aop"</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">schema声明:</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">http://www.springframework.org/schema/aop</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">http://www.springframework.org/schema/aop/spring-aop-2.0.xsd</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">然后加上这个标签:</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&lt;aop:aspectj-autoproxy/&gt; 有了这个Spring就能够自动扫描被@Aspect标注的切面了</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">最后是运行，很简单方便了：</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">public class Test {</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; public static void main(String[] args){</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ApplicationContext appCtx = new ClassPathXmlApplicationContext("applicationContext.xml");</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Sleepable human = (Sleepable)appCtx.getBean("human");</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; human.sleep();</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; }</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">}</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">下面我们来看最后一种常用的实现AOP的方式:使用Spring来定义纯粹的POJO切面</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">前面我们用到了&lt;aop:aspectj-autoproxy/&gt;标签,Spring在aop的命名空间里面还提供了其他的配置元素:</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&lt;aop:advisor&gt; 定义一个AOP通知者</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&lt;aop:after&gt; 后通知</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&lt;aop:after-returning&gt; 返回后通知</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&lt;aop:after-throwing&gt; 抛出后通知</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&lt;aop:around&gt; 周围通知</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&lt;aop:aspect&gt;定义一个切面</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&lt;aop:before&gt;前通知</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&lt;aop:config&gt;顶级配置元素，类似于&lt;beans&gt;这种东西</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&lt;aop:pointcut&gt;定义一个切点</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">我们用AOP标签来实现睡觉这个过程:</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">代码不变，只是修改配置文件,加入AOP配置即可:</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&lt;aop:config&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &lt;aop:aspect ref="sleepHelper"&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &lt;aop:before method="beforeSleep" pointcut="execution(* *.sleep(..))"/&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &lt;aop:after method="afterSleep" pointcut="execution(* *.sleep(..))"/&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&nbsp;&nbsp;&nbsp; &lt;/aop:aspect&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><span style="margin:0px;padding:0px;font-weight:400;color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;">&lt;/aop:config&gt;</span><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br style="color:rgb(51, 51, 51);font-family:Arial;font-size:0.875rem;"><br></p><p style="margin:0px;padding:0px;font-weight:400;"><span style="margin:0px;padding:0px;font-weight:400;font-family:Arial;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;font-weight:400;font-size:0.875rem;">主要平时项目中的话。看着这些注解代码就别奇怪了。应该明白他们是干嘛用的。</span></span></p><br><div style="color:gray;"><small>来源：&nbsp;<a href="http://blog.csdn.net/fjnpysh/article/details/64141050">http://blog.csdn.net/fjnpysh/article/details/64141050</a></small></div></div></body></html>