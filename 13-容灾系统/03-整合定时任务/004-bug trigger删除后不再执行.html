<!DOCTYPE HTML><html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>004-bug trigger删除后不再执行</title>
    
<style id="wiz_custom_css">html, body {font-size: 12pt;}body {font-family: Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;line-height: 1.6;margin: 0 auto;padding: 20px 16px;padding: 1.25rem 1rem;}h1, h2, h3, h4, h5, h6 {margin:20px 0 10px;margin:1.25rem 0 0.625rem;padding: 0;font-weight: bold;}h1 {font-size:20pt;font-size:1.67rem;}h2 {font-size:18pt;font-size:1.5rem;}h3 {font-size:15pt;font-size:1.25rem;}h4 {font-size:14pt;font-size:1.17rem;}h5 {font-size:12pt;font-size:1rem;}h6 {font-size:12pt;font-size:1rem;color: #777777;margin: 1rem 0;}div, p, ul, ol, dl, li {margin:0;}blockquote, table, pre, code {margin:8px 0;}ul, ol {padding-left:32px;padding-left:2rem;}ol.wiz-list-level1 > li {list-style-type:decimal;}ol.wiz-list-level2 > li {list-style-type:lower-latin;}ol.wiz-list-level3 > li {list-style-type:lower-roman;}blockquote {padding:0 12px;padding:0 0.75rem;}blockquote > :first-child {margin-top:0;}blockquote > :last-child {margin-bottom:0;}img {border:0;max-width:100%;height:auto !important;margin:2px 0;}table {border-collapse:collapse;border:1px solid #bbbbbb;}td, th {padding:4px 8px;border-collapse:collapse;border:1px solid #bbbbbb;min-height:28px;word-break:break-all;box-sizing: border-box;}.wiz-hide {display:none !important;}</style></head>

<body class=""  spellcheck="false"><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem; color: rgb(255, 0, 0);"><b>Caused by: org.quartz.JobPersistenceException: Couldn't store trigger 'DEFAULT.MT_8ru1g9qjdqs6g' for 'DEFAULT.JOB_TASK_2' job:The job (DEFAULT.JOB_TASK_2) referenced by the trigger does not exist. [See nested exception: org.quartz.JobPersistenceException: The job (DEFAULT.JOB_TASK_2) referenced by the trigger does not exist.]</b></span><br></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem; color: rgb(255, 0, 0);"><b>删除找不到</b></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem; color: rgb(255, 0, 0);"><b>(quartz内部使用了缓存,将数据库中储存的定时信息,取到内存,根据策略更新)</b></span></div><div><div><img src="004-bug trigger删除后不再执行_files/77347a40-3622-4be6-9344-8f736de50e30.png" class="" style="vertical-align: bottom; max-width: 100%;"></div><div><br></div><div><hr></div></div><div><br></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"> -█-&gt;&gt; QuartzJob -█-&gt;&gt; executeInternal -█-&gt;&gt; (ScheduleJob)JobExecutionContext,getMergedJobDataMap().get("JOB_PARAM_KEY");<br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"> -█-&gt;&gt; context.getMergedJobDataMap().get("JOB_PARAM_KEY"); -█-&gt;&gt; top.qiaojianyong.dt_ssh.pojo.ScheduleJob@e40541d<br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"> -█-&gt;&gt; currentThread -█-&gt;&gt; MyScheduler_Worker-13<br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"> -█-&gt;&gt; QuartzJob -█-&gt;&gt; create task object by reflect -█-&gt;&gt; scheduleJob.getBeanName() -█-&gt;&gt; testTask<br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"> -█-&gt;&gt; QuartzJob -█-&gt;&gt; 准备执行任务，任务ID：6<br></span></div><div><span data-wiz-span="data-wiz-span" style="color: rgb(255, 0, 0); font-size: 1.667rem;"><b>(--Reflect--)</b></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"><span data-wiz-span="data-wiz-span" style="color: rgb(255, 0, 0);">java.lang.NoSuchMethodException: top.qiaojianyong.dt_ssh.quartz.task.TestTask.test1(java.lang.String)</span><br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"><span data-wiz-span="data-wiz-span" style="color: rgb(255, 0, 0);">&nbsp; &nbsp; at java.lang.Class.getDeclaredMethod(Class.java:2130)</span><br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"><span data-wiz-span="data-wiz-span" style="color: rgb(255, 0, 0);">&nbsp; &nbsp; at top.qiaojianyong.dt_ssh.quartz.QuartzJob.executeInternal(QuartzJob.java:55)</span><br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"><span data-wiz-span="data-wiz-span" style="color: rgb(255, 0, 0);">&nbsp; &nbsp; at org.springframework.scheduling.quartz.QuartzJobBean.execute(QuartzJobBean.java:75)</span><br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"><span data-wiz-span="data-wiz-span" style="color: rgb(255, 0, 0);">&nbsp; &nbsp; at org.quartz.core.JobRunShell.run(JobRunShell.java:202)</span><br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size:1.333rem;color:rgb(255, 0, 0)">&nbsp; &nbsp; at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:573)</span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">Hibernate: <br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">&nbsp; &nbsp; insert <br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">&nbsp; &nbsp; into<br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">&nbsp; &nbsp; &nbsp; &nbsp; schedule_job_log<br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">&nbsp; &nbsp; &nbsp; &nbsp; (bean_name, create_time, error, job_id, method_name, params, status, times) <br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">&nbsp; &nbsp; values<br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">&nbsp; &nbsp; &nbsp; &nbsp; (?, ?, ?, ?, ?, ?, ?, ?)<br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"><div style="margin:0px;color:rgb(0, 0, 0);font-family:Consolas, Helvetica, 'Hiragino Sans GB', 微软雅黑, 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-size:1.333rem;">-█-&gt;&gt; QuartzJob -█-&gt;&gt; ScheduleJobLog{<br></span></div><div style="margin:0px;color:rgb(0, 0, 0);font-family:Consolas, Helvetica, 'Hiragino Sans GB', 微软雅黑, 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-size:1.333rem;">logId=51,<span class="Apple-converted-space">&nbsp;</span><br></span></div><div style="margin:0px;color:rgb(0, 0, 0);font-family:Consolas, Helvetica, 'Hiragino Sans GB', 微软雅黑, 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-size:1.333rem;">jobId=6,<span class="Apple-converted-space">&nbsp;</span><br></span></div><div style="margin:0px;color:rgb(0, 0, 0);font-family:Consolas, Helvetica, 'Hiragino Sans GB', 微软雅黑, 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-size:1.333rem;">beanName='testTask',<span class="Apple-converted-space">&nbsp;</span><br></span></div><div style="margin:0px;color:rgb(0, 0, 0);font-family:Consolas, Helvetica, 'Hiragino Sans GB', 微软雅黑, 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-size:1.333rem;">methodName='test1',<span class="Apple-converted-space">&nbsp;</span><br></span></div><div style="margin:0px;color:rgb(0, 0, 0);font-family:Consolas, Helvetica, 'Hiragino Sans GB', 微软雅黑, 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-size:1.333rem;">params='乔健勇',<span class="Apple-converted-space">&nbsp;</span><br></span></div><div style="margin:0px;color:rgb(0, 0, 0);font-family:Consolas, Helvetica, 'Hiragino Sans GB', 微软雅黑, 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-size:1.333rem;">status=1,<span class="Apple-converted-space">&nbsp;</span><br></span></div><div style="margin:0px;color:rgb(0, 0, 0);font-family:Consolas, Helvetica, 'Hiragino Sans GB', 微软雅黑, 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-size:1.333rem;">error='java.lang.NoSuchMethodException: top.qiaojianyong.dt_ssh.quartz.task.TestTask.test1(java.lang.String)',<span class="Apple-converted-space">&nbsp;</span><br></span></div><div style="margin:0px;color:rgb(0, 0, 0);font-family:Consolas, Helvetica, 'Hiragino Sans GB', 微软雅黑, 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-size:1.333rem;">times=0,<span class="Apple-converted-space">&nbsp;</span><br></span></div><div style="margin:0px;color:rgb(0, 0, 0);font-family:Consolas, Helvetica, 'Hiragino Sans GB', 微软雅黑, 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-size:1.333rem;">createTime=Sun Oct 22 20:06:50 CST 2017}</span></div><hr><span data-wiz-span="data-wiz-span" style="color: rgb(255, 0, 0);"><b><span data-wiz-span="data-wiz-span" style="font-size: 1.667rem;">Correct Situation</span></b></span></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"><div style="margin:0px;color:rgb(0, 0, 0);font-family:Consolas, Helvetica, 'Hiragino Sans GB', 微软雅黑, 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-size:1.333rem;">Hibernate:<span class="Apple-converted-space">&nbsp;</span><br></span></div><div style="margin:0px;color:rgb(0, 0, 0);font-family:Consolas, Helvetica, 'Hiragino Sans GB', 微软雅黑, 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-size:1.333rem;">&nbsp; &nbsp; insert<span class="Apple-converted-space">&nbsp;</span><br></span></div><div style="margin:0px;color:rgb(0, 0, 0);font-family:Consolas, Helvetica, 'Hiragino Sans GB', 微软雅黑, 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-size:1.333rem;">&nbsp; &nbsp; into<br></span></div><div style="margin:0px;color:rgb(0, 0, 0);font-family:Consolas, Helvetica, 'Hiragino Sans GB', 微软雅黑, 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-size:1.333rem;">&nbsp; &nbsp; &nbsp; &nbsp; schedule_job_log<br></span></div><div style="margin:0px;color:rgb(0, 0, 0);font-family:Consolas, Helvetica, 'Hiragino Sans GB', 微软雅黑, 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-size:1.333rem;">&nbsp; &nbsp; &nbsp; &nbsp; (bean_name, create_time, error, job_id, method_name, params, status, times)<span class="Apple-converted-space">&nbsp;</span><br></span></div><div style="margin:0px;color:rgb(0, 0, 0);font-family:Consolas, Helvetica, 'Hiragino Sans GB', 微软雅黑, 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-size:1.333rem;">&nbsp; &nbsp; values<br></span></div><div style="margin:0px;color:rgb(0, 0, 0);font-family:Consolas, Helvetica, 'Hiragino Sans GB', 微软雅黑, 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-size:1.333rem;">&nbsp; &nbsp; &nbsp; &nbsp; (?, ?, ?, ?, ?, ?, ?, ?)</span></div><br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">我是带参数的test方法，正在被执行，参数为：乔健勇</span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"> -█-&gt;&gt; QuartzJob -█-&gt;&gt; executeInternal -█-&gt;&gt; (ScheduleJob)JobExecutionContext,getMergedJobDataMap().get("JOB_PARAM_KEY");<br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"> -█-&gt;&gt; context.getMergedJobDataMap().get("JOB_PARAM_KEY"); -█-&gt;&gt; top.qiaojianyong.dt_ssh.pojo.ScheduleJob@32cc0dd2<br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"> -█-&gt;&gt; currentThread -█-&gt;&gt; MyScheduler_Worker-2<br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"> -█-&gt;&gt; QuartzJob -█-&gt;&gt; create task object by reflect -█-&gt;&gt; scheduleJob.getBeanName() -█-&gt;&gt; testTask<br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"> -█-&gt;&gt; QuartzJob -█-&gt;&gt; 准备执行任务，任务ID：7<br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"> -█-&gt;&gt; QuartzJob -█-&gt;&gt; 任务执行完毕，任务ID：7，总耗时：0毫秒</span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"> -█-&gt;&gt; QuartzJob -█-&gt;&gt; ScheduleJobLog{<br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">logId=58, <br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">jobId=7, <br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">beanName='testTask', <br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">methodName='test', <br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">params='乔健勇', <br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">status=0, <br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">error='null', <br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">times=0, <br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;">createTime=Sun Oct 22 20:24:00 CST 2017}<br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"><br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"><br></span></div><div><span data-wiz-span="data-wiz-span" style="font-size: 1.333rem;"><br></span></div></body></html>