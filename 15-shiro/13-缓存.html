<!DOCTYPE HTML><html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>13-缓存</title>
    
<style id="wiz_custom_css">html, body {font-size: 12pt;}body {font-family: Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;line-height: 1.6;margin: 0 auto;padding: 20px 16px;padding: 1.25rem 1rem;}h1, h2, h3, h4, h5, h6 {margin:20px 0 10px;margin:1.25rem 0 0.625rem;padding: 0;font-weight: bold;}h1 {font-size:20pt;font-size:1.67rem;}h2 {font-size:18pt;font-size:1.5rem;}h3 {font-size:15pt;font-size:1.25rem;}h4 {font-size:14pt;font-size:1.17rem;}h5 {font-size:12pt;font-size:1rem;}h6 {font-size:12pt;font-size:1rem;color: #777777;margin: 1rem 0;}div, p, ul, ol, dl, li {margin:0;}blockquote, table, pre, code {margin:8px 0;}ul, ol {padding-left:32px;padding-left:2rem;}ol.wiz-list-level1 > li {list-style-type:decimal;}ol.wiz-list-level2 > li {list-style-type:lower-latin;}ol.wiz-list-level3 > li {list-style-type:lower-roman;}blockquote {padding:0 12px;padding:0 0.75rem;}blockquote > :first-child {margin-top:0;}blockquote > :last-child {margin-bottom:0;}img {border:0;max-width:100%;height:auto !important;margin:2px 0;}table {border-collapse:collapse;border:1px solid #bbbbbb;}td, th {padding:4px 8px;border-collapse:collapse;border:1px solid #bbbbbb;min-height:28px;word-break:break-all;box-sizing: border-box;}.wiz-hide {display:none !important;}</style></head>

<body class=""  spellcheck="false"><div><h1><font face="Hack"><span data-wiz-span="data-wiz-span" style="color: rgb(255, 0, 0);">User 对象需要序列化</span></font></h1><div style="margin:0px;color:rgb(0, 0, 0);font-family:monospace;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-family:Hack;"><br class="Apple-interchange-newline">[net.sf.ehcache.store.disk.Segment]put added 0 on heap<br></span></div><div style="margin:0px;color:rgb(0, 0, 0);font-family:monospace;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-family:Hack;">[net.sf.ehcache.store.disk.Segment]put updated, deleted 0 on heap<br></span></div><div style="margin:0px;color:rgb(0, 0, 0);font-family:monospace;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-family:Hack;">[org.springframework.web.servlet.DispatcherServlet]DispatcherServlet with name 'SpringMVC' processing GET request for [/schsystem/css/bootstrap.min.css.map]<br></span></div><div style="margin:0px;color:rgb(0, 0, 0);font-family:monospace;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-family:Hack;">[org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping]Looking up handler method for path /css/bootstrap.min.css.map<br></span></div><div style="margin:0px;color:rgb(0, 0, 0);font-family:monospace;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-family:Hack;">[net.sf.ehcache.store.disk.DiskStorageFactory]Disk Write of 128a4b94-fb33-4f64-9212-aa60cdc5bb90 failed: <br></span></div><div style="margin:0px;color:rgb(0, 0, 0);font-family:monospace;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-family:Hack;"><b><span data-wiz-span="data-wiz-span" style="color:rgb(255, 0, 0);">java.io.NotSerializableException: com.pojo.User</span></b><br></span></div><div style="margin:0px;color:rgb(0, 0, 0);font-family:monospace;font-size:1rem;font-style:normal;font-weight:normal;text-align:start;text-indent:0px;"><span data-wiz-span="data-wiz-span" style="font-family:Hack;">&nbsp; &nbsp; at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1184)</span></div><hr><br><pre style="background-color:#2b2b2b;color:#a9b7c6;font-family:'Consolas';font-size:1.067rem;"><br><span style="color:#808080;">&lt;!-- </span><span style="color:#808080;font-family:'Courier New';">会话</span><span style="color:#808080;">ID</span><span style="color:#808080;font-family:'Courier New';">生成器 </span><span style="color:#808080;">--&gt;<br></span><span style="color:#e8bf6a;">&lt;bean </span><span style="color:#bababa;">id</span><span style="color:#6a8759;">="sessionIdGenerator" </span><span style="color:#bababa;">class</span><span style="color:#6a8759;">="org.apache.shiro.session.mgt.eis.JavaUuidSessionIdGenerator"</span><span style="color:#e8bf6a;">/&gt;<br></span><span style="color:#808080;">&lt;!-- </span><span style="color:#808080;font-family:'Courier New';">会话</span><span style="color:#808080;">Cookie</span><span style="color:#808080;font-family:'Courier New';">模板 关闭浏览器立即失效 </span><span style="color:#808080;">--&gt;<br></span><span style="color:#e8bf6a;">&lt;bean </span><span style="color:#bababa;">id</span><span style="color:#6a8759;">="sessionIdCookie" </span><span style="color:#bababa;">class</span><span style="color:#6a8759;">="org.apache.shiro.web.servlet.SimpleCookie"</span><span style="color:#e8bf6a;">&gt;<br></span><span style="color:#e8bf6a;">  &lt;constructor-arg </span><span style="color:#bababa;">value</span><span style="color:#6a8759;">="sid"</span><span style="color:#e8bf6a;">/&gt;<br></span><span style="color:#e8bf6a;">  &lt;property </span><span style="color:#bababa;">name</span><span style="color:#6a8759;">="httpOnly" </span><span style="color:#bababa;">value</span><span style="color:#6a8759;">="true"</span><span style="color:#e8bf6a;">/&gt;<br></span><span style="color:#e8bf6a;">  &lt;property </span><span style="color:#bababa;">name</span><span style="color:#6a8759;">="maxAge" </span><span style="color:#bababa;">value</span><span style="color:#6a8759;">="-1"</span><span style="color:#e8bf6a;">/&gt;<br></span><span style="color:#e8bf6a;">&lt;/bean&gt;<br></span><span style="color:#808080;">&lt;!-- </span><span style="color:#808080;font-family:'Courier New';">会话</span><span style="color:#808080;">DAO --&gt;<br></span><span style="color:#e8bf6a;">&lt;bean </span><span style="color:#bababa;">id</span><span style="color:#6a8759;">="sessionDAO" </span><span style="color:#bababa;">class</span><span style="color:#6a8759;">="org.apache.shiro.session.mgt.eis.EnterpriseCacheSessionDAO"</span><span style="color:#e8bf6a;">&gt;<br></span><span style="color:#e8bf6a;">  &lt;property </span><span style="color:#bababa;">name</span><span style="color:#6a8759;">="sessionIdGenerator" </span><span style="color:#bababa;">ref</span><span style="color:#6a8759;">="sessionIdGenerator"</span><span style="color:#e8bf6a;">/&gt;<br></span><span style="color:#e8bf6a;">&lt;/bean&gt;<br></span><span style="color:#808080;">&lt;!-- </span><span style="color:#808080;font-family:'Courier New';">会话验证调度器，每</span><span style="color:#808080;">30</span><span style="color:#808080;font-family:'Courier New';">分钟执行一次验证 ，设定会话超时及保存 </span><span style="color:#808080;">--&gt;<br></span><span style="color:#e8bf6a;">&lt;bean </span><span style="color:#bababa;">name</span><span style="color:#6a8759;">="sessionValidationScheduler"<br></span><span style="color:#6a8759;">      </span><span style="color:#bababa;">class</span><span style="color:#6a8759;">="org.apache.shiro.session.mgt.ExecutorServiceSessionValidationScheduler"</span><span style="color:#e8bf6a;">&gt;<br></span><span style="color:#e8bf6a;">  &lt;property </span><span style="color:#bababa;">name</span><span style="color:#6a8759;">="interval" </span><span style="color:#bababa;">value</span><span style="color:#6a8759;">="1800000"</span><span style="color:#e8bf6a;">/&gt;<br></span><span style="color:#e8bf6a;">  &lt;property </span><span style="color:#bababa;">name</span><span style="color:#6a8759;">="sessionManager" </span><span style="color:#bababa;">ref</span><span style="color:#6a8759;">="sessionManager"</span><span style="color:#e8bf6a;">/&gt;<br></span><span style="color:#e8bf6a;">&lt;/bean&gt;<br></span><span style="color:#808080;">&lt;!-- </span><span style="color:#808080;font-family:'Courier New';">会话管理器 </span><span style="color:#808080;">--&gt;<br></span><span style="color:#e8bf6a;">&lt;bean </span><span style="color:#bababa;">id</span><span style="color:#6a8759;">="sessionManager" </span><span style="color:#bababa;">class</span><span style="color:#6a8759;">="org.apache.shiro.web.session.mgt.DefaultWebSessionManager"</span><span style="color:#e8bf6a;">&gt;<br></span><span style="color:#e8bf6a;">  </span><span style="color:#808080;">&lt;!-- </span><span style="color:#808080;font-family:'Courier New';">全局会话超时时间（单位毫秒），默认</span><span style="color:#808080;">30</span><span style="color:#808080;font-family:'Courier New';">分钟 </span><span style="color:#808080;">--&gt;<br></span><span style="color:#808080;">  </span><span style="color:#e8bf6a;">&lt;property </span><span style="color:#bababa;">name</span><span style="color:#6a8759;">="globalSessionTimeout" </span><span style="color:#bababa;">value</span><span style="color:#6a8759;">="1800000"</span><span style="color:#e8bf6a;">/&gt;<br></span><span style="color:#e8bf6a;">  &lt;property </span><span style="color:#bababa;">name</span><span style="color:#6a8759;">="deleteInvalidSessions" </span><span style="color:#bababa;">value</span><span style="color:#6a8759;">="true"</span><span style="color:#e8bf6a;">/&gt;<br></span><span style="color:#e8bf6a;">  &lt;property </span><span style="color:#bababa;">name</span><span style="color:#6a8759;">="sessionValidationSchedulerEnabled" </span><span style="color:#bababa;">value</span><span style="color:#6a8759;">="true"</span><span style="color:#e8bf6a;">/&gt;<br></span><span style="color:#e8bf6a;">  &lt;property </span><span style="color:#bababa;">name</span><span style="color:#6a8759;">="sessionValidationScheduler" </span><span style="color:#bababa;">ref</span><span style="color:#6a8759;">="sessionValidationScheduler"</span><span style="color:#e8bf6a;">/&gt;<br></span><span style="color:#e8bf6a;">  &lt;property </span><span style="color:#bababa;">name</span><span style="color:#6a8759;">="sessionDAO" </span><span style="color:#bababa;">ref</span><span style="color:#6a8759;">="sessionDAO"</span><span style="color:#e8bf6a;">/&gt;<br></span><span style="color:#e8bf6a;">  &lt;property </span><span style="color:#bababa;">name</span><span style="color:#6a8759;">="sessionIdCookieEnabled" </span><span style="color:#bababa;">value</span><span style="color:#6a8759;">="true"</span><span style="color:#e8bf6a;">/&gt;<br></span><span style="color:#e8bf6a;">  &lt;property </span><span style="color:#bababa;">name</span><span style="color:#6a8759;">="sessionIdCookie" </span><span style="color:#bababa;">ref</span><span style="color:#6a8759;">="sessionIdCookie"</span><span style="color:#e8bf6a;">/&gt;<br></span><span style="color:#e8bf6a;">&lt;/bean&gt;<br></span><span style="color:#808080;">&lt;!-- </span><span style="color:#808080;font-family:'Courier New';">安全管理器 </span><span style="color:#808080;">--&gt;<br></span><span style="color:#e8bf6a;">&lt;bean </span><span style="color:#bababa;">id</span><span style="color:#6a8759;">="securityManager" </span><span style="color:#bababa;">class</span><span style="color:#6a8759;">="org.apache.shiro.web.mgt.DefaultWebSecurityManager"</span><span style="color:#e8bf6a;">&gt;<br></span><span style="color:#e8bf6a;">  &lt;property </span><span style="color:#bababa;">name</span><span style="color:#6a8759;">="realm" </span><span style="color:#bababa;">ref</span><span style="color:#6a8759;">="userRealm"</span><span style="color:#e8bf6a;">/&gt;<br></span><span style="color:#e8bf6a;">  &lt;property </span><span style="color:#bababa;">name</span><span style="color:#6a8759;">="cacheManager" </span><span style="color:#bababa;">ref</span><span style="color:#6a8759;">="cacheManager"</span><span style="color:#e8bf6a;">/&gt;<br></span><span style="color:#e8bf6a;">  &lt;property </span><span style="color:#bababa;">name</span><span style="color:#6a8759;">="sessionManager" </span><span style="color:#bababa;">ref</span><span style="color:#6a8759;">="sessionManager"</span><span style="color:#e8bf6a;">/&gt;<br></span><span style="color:#e8bf6a;">&lt;/bean&gt;<br></span><span style="color:#e8bf6a;">&lt;bean </span><span style="color:#bababa;">id</span><span style="color:#6a8759;">="userRealm" </span><span style="color:#bababa;">class</span><span style="color:#6a8759;">="com.shiro.UserRealm"</span><span style="color:#e8bf6a;">/&gt;<br></span><span style="color:#e8bf6a;">&lt;bean </span><span style="color:#bababa;">id</span><span style="color:#6a8759;">="cacheManager" </span><span style="color:#bababa;">class</span><span style="color:#6a8759;">="org.apache.shiro.cache.ehcache.EhCacheManager"</span><span style="color:#e8bf6a;">&gt;<br></span><span style="color:#e8bf6a;">  &lt;property </span><span style="color:#bababa;">name</span><span style="color:#6a8759;">="cacheManagerConfigFile" </span><span style="color:#bababa;">value</span><span style="color:#6a8759;">="classpath:ehcache.xml"</span><span style="color:#e8bf6a;">/&gt;<br></span><span style="color:#e8bf6a;">&lt;/bean&gt;</span></pre></div><h1>ehcache.xml</h1><div><pre style="background-color:#2b2b2b;color:#a9b7c6;font-family:'Consolas';font-size:1.067rem;"><span style="color:#e8bf6a;">&lt;ehcache&gt;<br></span><span style="color:#e8bf6a;">  &lt;diskStore </span><span style="color:#bababa;">path</span><span style="color:#6a8759;">="java.io.tmpdir"</span><span style="color:#e8bf6a;">/&gt;<br></span><span style="color:#e8bf6a;">  &lt;defaultCache<br></span><span style="color:#e8bf6a;">          </span><span style="color:#bababa;">maxEntriesLocalHeap</span><span style="color:#6a8759;">="2000"<br></span><span style="color:#6a8759;">          </span><span style="color:#bababa;">maxElementsInMemory</span><span style="color:#6a8759;">="10000"<br></span><span style="color:#6a8759;">          </span><span style="color:#bababa;">eternal</span><span style="color:#6a8759;">="false"<br></span><span style="color:#6a8759;">          </span><span style="color:#bababa;">timeToIdleSeconds</span><span style="color:#6a8759;">="120"<br></span><span style="color:#6a8759;">          </span><span style="color:#bababa;">timeToLiveSeconds</span><span style="color:#6a8759;">="120"<br></span><span style="color:#6a8759;">          </span><span style="color:#bababa;">overflowToDisk</span><span style="color:#6a8759;">="true"<br></span><span style="color:#6a8759;">  </span><span style="color:#e8bf6a;">/&gt;<br></span><span style="color:#e8bf6a;">&lt;/ehcache&gt;<br></span></pre><br></div></body></html>